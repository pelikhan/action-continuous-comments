# Continuous Documentation GitHub Action

This action regularly scans your codebase for functions that are missing documentation or have existing documentation.

This action is designed to be run regularly over your codebase, using a scheduled job.

The action uses [GenAIScript](https://microsoft.github.io/genaiscript/) and [AST-GREP](https://ast-grep.github.io/).

> [!NOTE]
> This action uses GitHub Models for LLM inference.

## Supported languages:

- TypeScript: `.ts`, `.tsx`, `.mts`, `.cts`

## Inputs

- `github_token`: GitHub token with `models: read` permission at least. (required)
- `instructions`: Additional prompting instructions for the LLM.
- `dry_run`: If true, the script will not modify files. (default: `false`)
- `missing`: Generate missing docs. (default: `true`)
- `update`: Update existing docs. (default: `false`)
- `max_files`: Maximum number of files to process. (default: `100`)
- `max_updates`: Maximum number of new or updated comments total. (default: `100`)
- `flex_tokens`: Maximum number of tokens to build content of requests. (default: `12000`)
- `debug`: Enable debug logging.

## Usage

Add the following to your step in your workflow file:

```yaml
uses: pelikhan/action-genai-commentor@main
with:
  github_token: ${{ secrets.GITHUB_TOKEN }}
```

## Example

```yaml
name: My action
on:
    schedule:
permissions:
    contents: read
    # issues: write
    pull-requests: write
    models: read
concurrency:
    group: ${{ github.workflow }}-${{ github.ref }}
    cancel-in-progress: true
jobs:
  run-script:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: pelikhan/action-genai-commentor@main
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
```

## Development

This action was automatically generated by GenAIScript from the script metadata.
We recommend updating the script metadata instead of editing the action files directly.

- the action inputs are inferred from the script parameters
- the action outputs are inferred from the script output schema
- the action description is the script title
- the readme description is the script description
- the action branding is the script branding

To **regenerate** the action files (`action.yml`, `Dockerfile`, `README.md`, `package.json`, `.gitignore`), run:

```bash
npm run configure
```

> [!CAUTION]
> This will overwrite any changes you made to these files!

To lint script files, run:

```bash
npm run lint
```

To typecheck the scripts, run:
```bash
npm run typecheck
```

To build the Docker image locally, run:
```bash
npm run docker:build
```

To run the action locally in Docker (build it first), use:
```bash
npm run docker:start
```

To run the action using [act](https://nektosact.com/), first install the act CLI:

```bash
npm run act:install
```

Then, you can run the action with:

```bash
npm run act
```

## Upgrade

The GenAIScript version is pinned in the `package.json` file. To upgrade it, run:

```bash
npm run upgrade
```

## Release

To release a new version of this action, run the release script on a clean working directory.

```bash
npm run release
```
